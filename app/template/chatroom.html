{% extends "base.html" %}
{% block content %}
<h3>
  <a href="{{ url_for('chats_page') }}">My Chats</a>
  &nbsp; > &nbsp; {{ chat_name }}
  <button class="delete list_del" type="submit" form="delete_chat_form" onClick="return confirm('Are you sure you want to delete this chat: {{ chat_name }} ?')">Delete chat</button>
</h3>
  <form type="hidden" id="delete_chat_form" action="{{ url_for('chats_page') }}" method="post">
    <input type="hidden" name="chat_id" value="{{ chat_id }}" id="{{ chat_id }}" />
  </form>
<hr>

<div> 

  <ul id="messages">
  {% if messages %}
    {% for message in messages %}
      <li>User: {{ message }}</li>
    {% endfor %}
  {% endif %}
  </ul>

  {% with flash_messages = get_flashed_messages() %}
  <ul id="flash_messages">
  {% if flash_messages %}
    {% for flash_message in flash_messages %}
      <li style="color: red;">- {{ flash_message }}</li>
    {% endfor %}
  {% endif %}
  </ul>
  {% endwith %}

  <input id="send_button" type="submit" onClick="return empty()" value="Send" style="float: right; width: 17%; text-align: center;"/>
  <div style="overflow: hidden; padding-right: 7%;">
     <input id="chat_message" style="width: 100%;" type="text" placeholder="Message" name="message"/>
  </div>â€‹

</div>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript">
  $(document).ready(
    function() {
      var socket = io.connect("http://0.0.0.0:5000");

      // Listening on "connect", with a callback function to tell us that user has connected
      socket.on("connect", function() {
        socket.send("User has connected!");
      })

      // Listening on "connect", with a callback function to tell us that user has connected
      socket.on("message", function(msg) {
        $("#messages").append("<li>" + msg + "</li>");
      });

      $("#send_button").on("click", function() {
        socket.send($("#chat_message").val());
        $("#chat_message").val("");
      })
    }
  );
</script>

{% endblock %}
