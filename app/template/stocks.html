{% extends "base.html" %}

{% block content %}
<style>
  .stampbox {
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    line-height: 15px;
    font-size: 85%;
  }
  td {
    line-height: 13px;
  }
  td.info {
    -webkit-line-clamp: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-box-orient: vertical;
  }
</style>
<h3>
  <div id="page_header">
    My Stocks
  </div>
</h3>
<hr><br>
<div>
  <ul>
  {% for ticker in tickers %}
    <li>
      <table style="width:97%; margin-right:3%">
        <tbody>
          <tr>
            <td class="info" style="width:100%;min-width:45px;float:left;padding-left:1%; padding-right:2.5%;">
              <div>
                <b><a style="color:#424242;" href="{{ url_for('stock_details_page', ticker_id=ticker.id) }}">{{ ticker.name }}</a></b>
              </div>
            </td>

            <td style="width:10%;min-width:45px;text-align:center;vertical-align:top;" rowspan="2">
              {% if ticker_recommendations[ticker.id]["recommendation"] == None %}

              {% elif 'sell' in ticker_recommendations[ticker.id]["recommendation"].lower() %}
              <div class="stampbox" style="background-color: #FFDBDA; border-color: #7d1128;">
                <a href="{{ url_for('stock_details_page', ticker_id=ticker.id) }}" style="color:#7d1128;">
                    <b>{{ ticker_recommendations[ticker.id]["recommendation"] }}</b>
                </a>
              </div>
              {% elif 'buy' in ticker_recommendations[ticker.id]["recommendation"].lower() %}
              <div class="stampbox" style="background-color: #e5efe5; border-color: #006600;">
                <a href="{{ url_for('stock_details_page', ticker_id=ticker.id) }}" style="color:#006600;">
                    <b>{{ ticker_recommendations[ticker.id]["recommendation"] }}</b>
                </a>
              </div>
              {% elif 'hold' in ticker_recommendations[ticker.id]["recommendation"].lower() %}
              <div class="stampbox" style="background-color: #efefef;">
                <a href="{{ url_for('stock_details_page', ticker_id=ticker.id) }}" style="color:#424242;">
                    {{ ticker_recommendations[ticker.id]["recommendation"] }}
                </a>
              </div>
              {% endif %}
            </td>

            <td style="width:20%;min-width:60px;text-align:center;font-size:95%;">
              <a style="color:#424242" href="{{ url_for('stock_details_page', ticker_id=ticker.id) }}">
                {{ '{:,.2f}'.format(ticker.price) }}
              </a>
            </td>
          </tr>

          <tr>
            <td class="info" style="width:100%;min-width:45px;padding-left:1%; padding-right:2.5%; font-size:85%;">
              {% if ticker.full_name != None %}
              <div>
                <a style="color:#7a7a7a;" href="{{ url_for('stock_details_page', ticker_id=ticker.id) }}">{{ ticker.full_name }}</a>
              </div>
              {% endif %}
            </td>
            <!-- <td style="width:10%;min-width:45px;text-align:center;"></td> -->
            <td style="width:20%;min-width:60px;text-align:center;">
              <div>
                <a href="{{ url_for('stock_details_page', ticker_id=ticker.id) }}">
                {% if ticker.change_percent > 0 %}
                <p style="color:#005100; font-size:85%;">&#9650;{{'{:0.1f}%'.format(ticker.change_percent * 100).replace("-","")}}</p>
                {% else %}
                <p style="color:#a81e26; font-size:85%;">&#9660;{{'{:0.1f}%'.format(ticker.change_percent * 100).replace("-","")}}</p>
                {% endif %}

                </a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <hr style="border-color: rgba(0, 0, 0, 0.05); border-width: 0.5px;">
    </li>
  {% endfor %}
  </ul>
</div>
<br>

<div id="page_header">
  <h4>Create New Ticker</h4>
</div>
<div class="form_div">
  <form action="" method="post">
    {{ form.hidden_tag() }}
    <p>
      {{ form.ticker_name.label }}<br><br>
      {{ form.ticker_name(size=32, class_="input_field") }}
      {% for error in form.ticker_name.errors %}
      <span style="color: red;">[{{ error }}]</span><br><br>
      {% endfor %}
    </p>
    <p id="submit_button">
      {{ form.submit(class_="form_button", onClick="return replace_with_loading_gif()") }}
      <div id="divMsg" style="display:none; padding-right: 5px; float: right;">
        <img src="{{url_for('static', filename='loading_icon.gif')}}" alt="Please wait.." />
      </div>
    </p>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <ul>
    {% for message in messages %}
    <li style="color: red;">- {{ message }}</li>
    {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}

  </form>
</div>

<script type="text/javascript">
  function replace_with_loading_gif() {
    document.getElementById('submit').style.display="none";
    document.getElementById('divMsg').style.display="block";
  };
</script>
{% endblock %}
